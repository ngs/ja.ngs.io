<!DOCTYPE html>
<html ⚡ itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <title>LilyPad Arduino で光る帽子を作った</title>
    <link itemprop="mainEntityOfPage" rel="canonical" href="https://ja.ngs.io/2014/08/27/ledcap/">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <style amp-custom>
      body {
        background-color: white;
        color: #404040;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: 14px;
      }
      amp-img {
        background-color: gray;
      }

      .container {
        padding: 0 8px;
      }

      @media (min-width: 480px) {
        .container {
          padding: 0 16px;
        }
      }

    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article class="container">
      <h1 itemprop="headline">LilyPad Arduino で光る帽子を作った</h1>
      <h2 itemprop="author" itemscope itemtype="https://schema.org/Person">
        <span itemprop="name">長瀬 敦史</span>
      </h2>
      <time itemprop="datePublished" datetime="2014-08-26T23:40:00">2014-08-27 08:40</time>
      <meta itemprop="description" content="LilyPad Arduino で暗くなると LED が光る帽子を作りました。"></meta>
      <div class="hidden article-metadata"><meta content="LilyPad Arduino で暗くなると LED が光る帽子を作りました。" itemprop="headline" /><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"><meta content="https://ja.ngs.io/images/2014-08-27-ledcap/1.jpg" itemprop="url" /><meta content="992" itemprop="width" /><meta content="525" itemprop="height" /></div><div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta content="Atsushi Nagase" itemprop="name" /><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"><meta content="https://ja.ngs.io/images/amp-logo.png" itemprop="url" /><meta content="600" itemprop="width" /><meta content="60" itemprop="height" /></div></div><meta content="2014-08-26T23:40:00" itemprop="dateModified" /></div>
      

<p>妻とのコラボで、<a href="http://lilypadarduino.org/?p=289">LilyPad Arduino</a> で暗くなると LED が光る帽子を作りました。</p>

<p>実装はとても簡単なものでしたが、導電糸の縫い付けがとても難儀でした。</p>



<p><amp-img src="/images/2014-08-27-ledcap/1.jpg" layout="responsive" width="992" height="525"></amp-img></p>

<p>帽子本体は妻作。</p>

<p><amp-img src="/images/2014-08-27-ledcap/2.jpg" layout="responsive" width="992" height="525"></amp-img></p>

<p>暗くなると光ります。</p>

<p><amp-img src="/images/2014-08-27-ledcap/3.jpg" layout="responsive" width="992" height="525"></amp-img></p>

<p>普通の糸でまず仮止めして、</p>

<p><amp-img src="/images/2014-08-27-ledcap/4.jpg" layout="responsive" width="992" height="525"></amp-img></p>

<p>導電糸で縫い付けます。</p>

<p><amp-img src="/images/2014-08-27-ledcap/5.jpg" layout="responsive" width="992" height="525"></amp-img></p>

<p>ただ縫い付けただけだと、帽子の裏でショートしてしまうので、絶縁に工夫が必要です。</p>

<p>この写真では仮にセロハンテープで固定しています。</p>

<p>また、LED 素子が焼けてしまって交換に苦労したので、メンテナンス性を考慮していなかったことが反省点です。</p>

<h2 id="素材">素材</h2>

<ul>
<li><a href="http://www.amazon.co.jp/gp/product/B00FPHR7I6/ref=as_li_ss_tl?ie=UTF8&amp;amp;camp=247&amp;amp;creative=7399&amp;amp;creativeASIN=B00FPHR7I6&amp;amp;linkCode=as2&amp;amp;tag=atsushnagased-22">LilyPad Arduino SimpleSnap</a>
</li><li><a href="http://www.amazon.co.jp/gp/product/B00C1WU6WM/ref=as_li_ss_tl?ie=UTF8&amp;amp;camp=247&amp;amp;creative=7399&amp;amp;creativeASIN=B00C1WU6WM&amp;amp;linkCode=as2&amp;amp;tag=atsushnagased-22">導電糸 (太)</a>
</li><li><a href="http://www.amazon.co.jp/gp/product/B00DDKM3LS/ref=as_li_ss_tl?ie=UTF8&amp;amp;camp=247&amp;amp;creative=7399&amp;amp;creativeASIN=B00DDKM3LS&amp;amp;linkCode=as2&amp;amp;tag=atsushnagased-22">LilyPad LED Micro</a>
</li><li><a href="http://www.amazon.co.jp/gp/product/B00DDID68Y/ref=as_li_ss_tl?ie=UTF8&amp;amp;camp=247&amp;amp;creative=7399&amp;amp;creativeASIN=B00DDID68Y&amp;amp;linkCode=as2&amp;amp;tag=atsushnagased-22">LilyPad 明るさセンサ</a>
</li><li><a href="http://www.amazon.co.jp/gp/product/B009AME9R4/ref=as_li_ss_tl?ie=UTF8&amp;amp;camp=247&amp;amp;creative=7399&amp;amp;creativeASIN=B009AME9R4&amp;amp;linkCode=as2&amp;amp;tag=atsushnagased-22">FTDI USB シリアル変換アダプター</a> (プログラムの書き込みに必要)
</li></ul>

<h2 id="実装">実装</h2>

<p><amp-img src="/images/2014-08-27-ledcap/Sketch.png" layout="responsive" width="1550" height="1550"></amp-img></p>

<pre class="highlight cpp"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">temt6000Pin</span> <span class="o">=</span> <span class="n">A5</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">ledPins</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">};</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">ledSize</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">ledDelay</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">ledCursor</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">ledCursor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">temt6000Pin</span><span class="p">,</span> <span class="n">INPUT</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ledSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pinMode</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">boolean</span> <span class="nf">isDark</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">temt6000Pin</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">allOff</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ledSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LOW</span><span class="p">);</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">allOn</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ledSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">HIGH</span><span class="p">);</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mh">0xff</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">isDark</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">ledCursor</span><span class="p">],</span> <span class="n">HIGH</span><span class="p">);</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">ledCursor</span><span class="p">],</span> <span class="mh">0xff</span><span class="p">);</span>
    <span class="n">delay</span><span class="p">(</span><span class="n">ledDelay</span><span class="p">);</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">ledCursor</span><span class="p">],</span> <span class="n">LOW</span><span class="p">);</span>
    <span class="n">analogWrite</span><span class="p">(</span><span class="n">ledPins</span><span class="p">[</span><span class="n">ledCursor</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">++</span><span class="n">ledCursor</span> <span class="o">==</span> <span class="n">ledSize</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">ledCursor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">allOff</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<p>ソースコードは GitHub で管理しています。 <strong><a href="https://github.com/ngs/LEDCap">ngs/ledcap</a></strong></p>

    </article>
  </body>
</html>
